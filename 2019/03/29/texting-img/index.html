<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>Texting Img | 啵啵啵</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="::selection {        color: #efefef;        background-color: #212121;    } div.contain {     width: 800px;     height: 800px;     display: flex;     background-color: #efefef; }  canvas {     fl">
<meta name="keywords" content="啵啵啵,PyroHo,MyBall,my-ball">
<meta property="og:type" content="article">
<meta property="og:title" content="Texting Img">
<meta property="og:url" content="https://pyroho.github.io/2019/03/29/texting-img/index.html">
<meta property="og:site_name" content="啵啵啵">
<meta property="og:description" content="::selection {        color: #efefef;        background-color: #212121;    } div.contain {     width: 800px;     height: 800px;     display: flex;     background-color: #efefef; }  canvas {     fl">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-03-29T04:52:52.975Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Texting Img">
<meta name="twitter:description" content="::selection {        color: #efefef;        background-color: #212121;    } div.contain {     width: 800px;     height: 800px;     display: flex;     background-color: #efefef; }  canvas {     fl">
  
    <link rel="alternate" href="/atom.xml" title="啵啵啵" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">啵啵啵</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">痛啵欲生</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://pyroho.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-texting-img" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/29/texting-img/" class="article-date">
  <time datetime="2019-03-29T04:45:39.215Z" itemprop="datePublished">2019-03-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Texting Img
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><div class="contain"></div></p>
<p><style type="text/css"><br>    ::selection {<br>        color: #efefef;<br>        background-color: #212121;<br>    }</p>
<pre><code>div.contain {
    width: 800px;
    height: 800px;
    display: flex;
    background-color: #efefef;
}

canvas {
    flex: 1;
}

.textarea-box {
    display: flex;
    flex: 3;
    flex-direction: column;
}

textarea {
    white-space: nowrap;
    font-size: 16px;
    flex: 1;
    resize: none;
    height: 50%;
}

button, label {
    color: #333;
    background-color: #fff;
    display: inline-block;
    padding: 6px 12px;
    /*margin-bottom: 0;*/
    font-size: 14px;
    font-weight: 400;
    line-height: 1.42857143;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
    background-image: none;
    border: 1px solid #ccc;
    border-radius: 4px;
    transition: .3s;
}

label:hover, button:hover {
    color: #333;
    background-color: #e6e6e6;
    border-color: #adadad;
}

label input {
    vertical-align: middle;
    cursor: pointer;
}

label {
    margin-top: 5px;
    margin-bottom: 5px;
}

button.danger {
    color: #fff;
    background-color: #d9534f;
    border-color: #d43f3a;
}

button.danger:hover {
    color: #fff;
    background-color: #c9302c;
    border-color: #ac2925;
}

button.primary {
    color: #fff;
    background-color: #337ab7;
    border-color: #2e6da4;
}

button.primary:hover {
    color: #fff;
    background-color: #286090;
    border-color: #204d74;
}
</code></pre><p></style></p>
<p><canvas>Not Support</canvas></p>
<p><div class="textarea-box"><br>    <textarea style="
            flex: 8;
            letter-spacing: -3px;
            line-height: 18px;
            font-family: Arial;">// drop image </textarea><br>    <div><br>        <label>width :<br>            <input oninput="update()" id="width" name="width" type="range" min="10" max="400" step="1" value="110"><br>        </label><br>        <label>color :<br>            <input oninput="update()" id="color" name="color" type="range" min="1" max="254" step="1" value="163"><br>        </label><br>        <label>reverse :<br>            <input onchange="update()" id="reverse" name="reverse" type="checkbox" checked><br>        </label><br>        <label>width-scale :<br>            <input oninput="update()" id="width-scale" name="widthScale" type="number" min="0.1" max="1" step="0.1" value="0.8"><br>        </label><br>        <label>smoothing :<br>            <input onchange="update()" id="smoothing" name="smoothing" type="checkbox" checked><br>        </label><br>        <button class="primary" onclick="eval(document.querySelector('#code').value);">run!<br>        </button><br>    </div><br>    <textarea id="code" ondblclick="eval(this.value)"><br>// double click to run<br>transform(80, 127, true)<br>    </textarea><br></div></p>
<p><script><br>window.addEventListener(‘load’, function(ev) {<br>    var texts = “⠁⠁⠂⠃⠄⠅⠆⠇⡀⡁⡂⡃⡄⡅⡆⡇⠈⠉⠊⠋⠌⠍⠎⠏⡈⡉⡊⡋⡌⡍⡎⡏⠐⠑⠒⠓⠔⠕⠖⠗⡐⡑⡒⡓⡔⡕⡖⡗⠘⠙⠚⠛⠜⠝⠞⠟⡘⡙⡚⡛⡜⡝⡞⡟⠠⠡⠢⠣⠤⠥⠦⠧⡠⡡⡢⡣⡤⡥⡦⡧⠨⠩⠪⠫⠬⠭⠮⠯⡨⡩⡪⡫⡬⡭⡮⡯⠰⠱⠲⠳⠴⠵⠶⠷⡰⡱⡲⡳⡴⡵⡶⡷⠸⠹⠺⠻⠼⠽⠾⠿⡸⡹⡺⡻⡼⡽⡾⡿⢀⢁⢂⢃⢄⢅⢆⢇⣀⣁⣂⣃⣄⣅⣆⣇⢈⢉⢊⢋⢌⢍⢎⢏⣈⣉⣊⣋⣌⣍⣎⣏⢐⢑⢒⢓⢔⢕⢖⢗⣐⣑⣒⣓⣔⣕⣖⣗⢘⢙⢚⢛⢜⢝⢞⢟⣘⣙⣚⣛⣜⣝⣞⣟⢠⢡⢢⢣⢤⢥⢦⢧⣠⣡⣢⣣⣤⣥⣦⣧⢨⢩⢪⢫⢬⢭⢮⢯⣨⣩⣪⣫⣬⣭⣮⣯⢰⢱⢲⢳⢴⢵⢶⢷⣰⣱⣲⣳⣴⣵⣶⣷⢸⢹⢺⢻⢼⢽⢾⢿⣸⣹⣺⣻⣼⣽⣾⣿”;</p>
<pre><code>var canvas = document.querySelector(&apos;canvas&apos;);
var output = document.querySelector(&quot;textarea&quot;);
var ctx = canvas.getContext(&apos;2d&apos;);
var SCREEN_WIDTH = canvas.width = 800 * .25,
    SCREEN_HEIGHT = canvas.height = 800;

function update() {
    var width = document.querySelector(&quot;#width&quot;).value;
    var color = document.querySelector(&quot;#color&quot;).value;
    var reverse = document.querySelector(&quot;#reverse&quot;).checked;
    var widthScale = document.querySelector(&quot;#width-scale&quot;).value;
    var smoothing = document.querySelector(&quot;#smoothing&quot;).checked;
    var code = document.querySelector(&quot;#code&quot;);
    code.value = &quot;transform( &quot;
        + width + &quot;, &quot;
        + color + &quot;, &quot;
        + reverse + &quot;, &quot;
        + smoothing + &quot;, &quot;
        + widthScale + &quot; )&quot;;
    eval(code.value);
}

dropAble(document.body, img2NumberArray);

function dropAble(el, imgHandler) {
    function drop(ev) {
        ignoreDrag(ev);
        var files = ev.dataTransfer.files;
        //读取图片
        var reader = new FileReader();
        reader.onload = function (e) {
            img.src = e.target.result;
        };
        reader.readAsDataURL(files[0]);
        img.onload = function () {
            imgHandler({
                img: img,
                textWidth: img.width
            });
        };
    }
    function ignoreDrag(e) {
        //因为我们在处理拖放，所以应该确保没有其他元素会取得这个事件
        e.stopPropagation();
        e.preventDefault();
    }
    el.ondragenter = ignoreDrag;
    el.ondragover = ignoreDrag;
    el.ondrop = drop;
}
var img = new Image();

function img2NumberArray(options) {
    var o = options;
    var width = o.textWidth, height;
    var result = [];
    ctx.imageSmoothingEnabled = o.smoothing;
    o.widthScale = o.widthScale || 1;

    ctx.clearRect(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);
</code></pre><p>//        if(width) {<br>        height = (o.img.height / o.img.width) <em> width / o.widthScale;<br>//        } else {<br>//            width = (img.width/img.height) </em> height;<br>//        }<br>        ctx.drawImage(o.img, 0, 0, o.img.width, o.img.height, 0, 0, width, height);</p>
<pre><code>    var imgData = ctx.getImageData(0, 0, width, height);
    // imgData { data: [r,g,b,a, r,g,b,a], width: int, height: int }
    var data = imgData.data;
    var avgColor;
    for (var i = 0; i &lt; data.length; i += 4) {
        avgColor = (data[i] + data[i + 1] + data[i + 2]) / 3;
        if (o.reverse) {
            result.push(avgColor &gt; o.color ? 1 : 0);
        } else {
            result.push(avgColor &gt; o.color ? 0 : 1);
        }

        data[i] = data[i+1] = data[i+2] = avgColor &gt; o.color ? 255 : 0;
    }

   ctx.putImageData(imgData, 0, height);
    // 在换成二维数组
    var arr = [];
    while (result.length &gt; 0) {
        arr.unshift(result.splice(-width));
    }
    return arr;
}

function transform(width, color, reverse, smoothing, widthScale) {
    var pxMap = img2NumberArray({
        img: img,
        textWidth: width || 80,
        color: color || 127,
        reverse: reverse || false,
        smoothing: smoothing || false,
        widthScale: widthScale || 1
    });
    output.value = arr2text(pxMap, texts, 2, 4);
}

function arr2text(mappingArray, texts, column, row) {
    var outputStr = &quot;&quot;;
    var arr = mappingArray;
    for (var y = 0; y &lt; arr.length; y += row) {
        for (var x = 0; x &lt; arr[y].length; x += column) {
            // 每个 column*row 的字符格子
            var index = &quot;0B&quot;;
            for (var tempCol = column; tempCol &gt; 0; tempCol--) {
                for (var tempRow = row; tempRow &gt; 0; tempRow--) {
                    var yy = y + tempRow - 1;
                    var xx = x + tempCol - 1;
                    if ((typeof arr[yy]) === &apos;undefined&apos; || (typeof arr[yy][xx]) === &apos;undefined&apos;) {
                        index += 0;
                        continue;
                    }
                    index += arr[yy][xx];
                }
            }
            console.log(index, index.toString(2));
            outputStr += texts.charAt(index.toString(2));
        }
        outputStr += &quot;\n&quot;;
    }
    console.log(outputStr);
    return outputStr;
}
</code></pre><p>}, false);<br></script><br><br><a id="more"></a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://pyroho.github.io/2019/03/29/texting-img/" data-id="cjttlcwz50000jwwi7580lmpp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/03/29/md/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">我爱黎明</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/PyroHo/">PyroHo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/我爱黎明/">我爱黎明</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/PyroHo/" style="font-size: 10px;">PyroHo</a> <a href="/tags/我爱黎明/" style="font-size: 10px;">我爱黎明</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/03/29/texting-img/">Texting Img</a>
          </li>
        
          <li>
            <a href="/2019/03/29/md/">我爱黎明</a>
          </li>
        
          <li>
            <a href="/2019/03/29/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 PyroHo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>